source("libgimli.R")
system("head S000RD13.tss.bed")
meth<-libgimli$load.meth("~/Desktop/meth_data/C004GD51_cpg.chr1.txt.gz")
?timestamp
timestamp
timestamp()
##------ Sat Jan 10 22:48:23 2015 ------##
date()
head(meth)
meth.rd<-libgimli$rd.of.meth(meth,2,c(6,7))
libgimli$take.slice(meth.rd,171314228-100,171314228+100)
libgimli$take.slice(meth.rd,171314228-1000,171314228+1000)
tss1<-libgimli$take.slice(meth.rd,171314228-1000,171314228+1000)
Start(tss1)
start(tss1)
tss1$nc
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c))
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c),type='b')
abline(v=171314228)
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c),type='b')
abline(v=171314228)
tss1<-libgimli$take.slice(meth.rd,171314228-1000,171314228+1000)
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c),type='b')
abline(v=171314228)
tss1<-libgimli$take.slice(meth.rd,171314228-1000,171314228+2000)
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c),type='b')
abline(v=171314228)
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c),type='b',ylim=c(0,1))
plot(start(tss1),tss1$nc/(tss1$nc+tss1$c),type='b',ylim=c(0,1))
abline(v=171314228)
tss2<-libgimli$take.slice(meth.rd,117452679-1000,117452679+1000)
plot(start(tss2),tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1))
abline(v=117452679)
plot(start(tss2),tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1))
abline(v=117452679)
tss2<-libgimli$take.slice(meth.rd,117452679-1000,117452679+2000)
plot(start(tss2),tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1))
abline(v=117452679)
tss3<-libgimli$take.slice(meth.rd,41157320-1000,41157320+1000)
plot(start(tss3),tss3$nc/(tss3$nc+tss3$c),type='b',ylim=c(0,1))
abline(v=41157320)
plot(start(tss3),tss3$nc/(tss3$nc+tss3$c),type='b',ylim=c(0,1))
abline(v=41157320)
plot(start(tss3),tss3$nc/(tss3$nc+tss3$c),type='b',ylim=c(0,1))
tss3<-libgimli$take.slice(meth.rd,41157320-1000,41157320+2000)
plot(start(tss3),tss3$nc/(tss3$nc+tss3$c),type='b',ylim=c(0,1))
plot(start(tss2),tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1))
plot(tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1))
lines(tss3$nc/(tss3$nc+tss3$c),type='b')
plot(tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1),col="blue")
lines(tss3$nc/(tss3$nc+tss3$c),type='b',col="red")
plot(start(tss2)-start(tss2)[1],tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1))
plot(start(tss2)-start(tss2)[1],tss2$nc/(tss2$nc+tss2$c),type='b',ylim=c(0,1),col="blue")
lines(start(tss3)-start(tss3)[1],tss3$nc/(tss3$nc+tss3$c),type='b',col="red")
savehistory("looking_for_tss.R")
